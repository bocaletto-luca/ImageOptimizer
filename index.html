<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>ImageOptimizer â€“ Client-Side Image Compressor</title>
  <meta name="description" content="ImageOptimizer by Bocaletto Luca â€“ Compress and resize images entirely in the browser. Supports PNG, JPEG & WebP output, adjustable quality and max dimensions.">
  <meta name="keywords" content="ImageOptimizer, image compressor, png compressor, browser, client-side, resize, quality, webp, jpeg">
  <meta name="author" content="Bocaletto Luca">
  <link rel="canonical" href="https://bocaletto-luca.github.io/ImageOptimizer/index.html"/>

  <!-- Open Graph -->
  <meta property="og:title" content="ImageOptimizer â€“ Client-Side Image Compressor"/>
  <meta property="og:description" content="Compress and resize PNG, JPEG or WebP images directly in your browser with ImageOptimizer."/>
  <meta property="og:type" content="website"/>
  <meta property="og:url" content="https://bocaletto-luca.github.io/ImageOptimizer/index.html"/>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "ImageOptimizer",
    "url": "https://bocaletto-luca.github.io/ImageOptimizer/index.html",
    "description": "Compress and resize images in the browser with adjustable quality and dimensions.",
    "creator": {
      "@type": "Person",
      "name": "Bocaletto Luca",
      "url": "https://github.com/bocaletto-luca"
    }
  }
  </script>

  <style>
    :root {
      --bg: #f5f5f5;
      --card: #fff;
      --text: #333;
      --primary: #0066cc;
      --accent: #28a745;
    }
    [data-theme="dark"] {
      --bg: #1e1e1e;
      --card: #2c2c2c;
      --text: #ddd;
      --primary: #339af0;
      --accent: #5cb85c;
    }
    * { box-sizing:border-box; margin:0; padding:0; }
    body {
      display:flex; flex-direction:column; min-height:100vh;
      font-family:Arial,sans-serif; background:var(--bg); color:var(--text);
    }
    header, footer {
      background:var(--primary); color:#fff; text-align:center; padding:1rem;
    }
    main {
      flex:1; max-width:960px; width:100%; margin:1rem auto; padding:1rem;
    }
    .controls {
      display:flex; flex-wrap:wrap; gap:.5rem; margin-bottom:1rem;
    }
    .controls label {
      display:flex; flex-direction:column; font-size:.9rem;
    }
    .controls input[type="range"],
    .controls input[type="number"],
    .controls select {
      margin-top:.2rem; padding:.4rem;
    }
    .controls button {
      padding:.5rem 1rem; background:var(--accent); color:#fff;
      border:none; border-radius:4px; cursor:pointer;
      transition:background .2s;
    }
    .controls button:hover { background:#218838; }

    #dropZone {
      border:2px dashed #aaa; border-radius:6px;
      padding:2rem; text-align:center; color:#777;
      background:var(--card); margin-bottom:1rem;
      cursor:pointer;
    }
    #dropZone.dragover {
      border-color:var(--primary); color:var(--primary);
    }
    #gallery {
      display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
      gap:1rem;
    }
    .preview {
      background:var(--card); border-radius:6px; padding:.5rem;
      box-shadow:0 2px 4px rgba(0,0,0,0.1); display:flex;
      flex-direction:column; align-items:center;
    }
    .preview img {
      max-width:100%; height:auto; border-radius:4px;
    }
    .info { margin-top:.5rem; font-size:.9rem; text-align:center; }
    .info span { display:block; margin-top:.2rem; }
    .info .download {
      margin-top:.4rem; color:var(--primary); text-decoration:underline;
      cursor:pointer;
    }
  </style>
</head>
<body data-theme="light">
  <header>
    <h1>ImageOptimizer</h1>
    <p>Compress &amp; Resize Images Client-Side â€” No Uploads</p>
  </header>

  <main>
    <div id="dropZone">Drag &amp; drop images here or click to select files</div>

    <div class="controls">
      <label>
        Format
        <select id="formatSelect">
          <option value="image/jpeg">JPEG</option>
          <option value="image/png">PNG</option>
          <option value="image/webp">WebP</option>
        </select>
      </label>
      <label>
        Quality (<span id="qualityValue">0.8</span>)
        <input type="range" id="qualityRange" min="0.1" max="1" step="0.05" value="0.8"/>
      </label>
      <label>
        Max Width (px)
        <input type="number" id="maxWidth" placeholder="e.g. 800" min="1"/>
      </label>
      <button id="btnCompress">Compress All</button>
      <button id="btnTheme">ðŸŒ™ Dark Mode</button>
      <input type="file" id="fileInput" accept="image/*" multiple style="display:none"/>
    </div>

    <div id="gallery"></div>
  </main>

  <footer>
    Â© 2025 Bocaletto Luca | 
    <a href="https://github.com/bocaletto-luca/ImageOptimizer" target="_blank" rel="noopener">Repository</a>
  </footer>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const dropZone    = document.getElementById('dropZone');
    const fileInput   = document.getElementById('fileInput');
    const formatSel   = document.getElementById('formatSelect');
    const qualityRng  = document.getElementById('qualityRange');
    const qualityVal  = document.getElementById('qualityValue');
    const maxWidthIn  = document.getElementById('maxWidth');
    const btnCompress = document.getElementById('btnCompress');
    const btnTheme    = document.getElementById('btnTheme');
    const gallery     = document.getElementById('gallery');
    const body        = document.body;

    let files = [];

    // Theme toggle
    btnTheme.addEventListener('click', () => {
      const next = body.dataset.theme === 'light' ? 'dark' : 'light';
      body.dataset.theme = next;
      btnTheme.textContent = next === 'dark' ? 'â˜€ï¸ Light Mode' : 'ðŸŒ™ Dark Mode';
    });

    // Quality display
    qualityRng.addEventListener('input', () => {
      qualityVal.textContent = qualityRng.value;
    });

    // File picker
    dropZone.addEventListener('click', () => fileInput.click());
    fileInput.addEventListener('change', e => handleFiles(e.target.files));

    // Drag & drop
    ['dragenter','dragover'].forEach(evt => {
      dropZone.addEventListener(evt, e => {
        e.preventDefault();
        dropZone.classList.add('dragover');
      });
    });
    ['dragleave','drop'].forEach(evt => {
      dropZone.addEventListener(evt, e => {
        e.preventDefault();
        dropZone.classList.remove('dragover');
      });
    });
    dropZone.addEventListener('drop', e => {
      handleFiles(e.dataTransfer.files);
    });

    function handleFiles(fileList) {
      for (let f of fileList) {
        if (!f.type.startsWith('image/')) continue;
        files.push(f);
      }
      renderPreviews();
    }

    function renderPreviews() {
      gallery.innerHTML = '';
      files.forEach((file, idx) => {
        const div = document.createElement('div');
        div.className = 'preview';
        div.innerHTML = `
          <img src="" alt="${file.name} preview"/>
          <div class="info">
            <span>${file.name}</span>
            <span>Original: ${(file.size / 1024).toFixed(1)} KB</span>
            <span class="result"></span>
          </div>`;
        gallery.appendChild(div);

        const img = div.querySelector('img');
        const reader = new FileReader();
        reader.onload = () => img.src = reader.result;
        reader.readAsDataURL(file);
      });
    }

    btnCompress.addEventListener('click', () => {
      const format  = formatSel.value;
      const quality = parseFloat(qualityRng.value);
      const maxW    = parseInt(maxWidthIn.value) || null;

      files.forEach((file, idx) => {
        const preview = gallery.children[idx];
        const img = new Image();
        const resultSpan = preview.querySelector('.result');

        img.onload = () => {
          const w = maxW && img.width > maxW ? maxW : img.width;
          const h = img.height * (w / img.width);

          const canvas = document.createElement('canvas');
          canvas.width = w;
          canvas.height = h;
          const ctx = canvas.getContext('2d');
          ctx.drawImage(img, 0, 0, w, h);

          canvas.toBlob(blob => {
            const url = URL.createObjectURL(blob);
            preview.querySelector('img').src = url;
            resultSpan.textContent = `Compressed: ${(blob.size / 1024).toFixed(1)} KB`;

            let dl = preview.querySelector('.download');
            if (!dl) {
              dl = document.createElement('a');
              dl.className = 'download';
              dl.textContent = 'Download';
              preview.querySelector('.info').appendChild(dl);
            }
            dl.href = url;
            dl.download = `optimized-${file.name}`;
          }, format, quality);
        };

        img.src = URL.createObjectURL(file);
      });
    });
  });
  </script>
</body>
</html>
